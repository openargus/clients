#  Gargoyle Client Software. Tools to read, analyze and manage Argus data.
#  Copyright (c) 2018-2024 QoSient, LLC
#  All rights reserved.
#
#  THE ACCOMPANYING PROGRAM IS PROPRIETARY SOFTWARE OF QoSIENT, LLC,
#  AND CANNOT BE USED, DISTRIBUTED, COPIED OR MODIFIED WITHOUT
#  EXPRESS PERMISSION OF QoSIENT, LLC.
#
#  QOSIENT, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS
#  SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
#  AND FITNESS, IN NO EVENT SHALL QOSIENT, LLC BE LIABLE FOR ANY
#  SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
#  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER
#  IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
#  ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
#  THIS SOFTWARE.

prefix = @prefix@
exec_prefix = @exec_prefix@
datarootdir = @datarootdir@
pythonextlib = @PYTHON_EXT_LIB@
PYTHON = python3
PYTHON_CFLAGS = $(shell $(PYTHON)-config --cflags)

# Pathname of directory to install the system binaries
SBINDIR = @sbindir@
# # Pathname of directory to install the system binaries
BINDIR = @bindir@
# Pathname of directory to install the include files
INCLDEST = @includedir@
# Pathname of directory to install the library
LIBDEST =  @libdir@
# Pathname of directory to install the man page
MANDEST = @mandir@
srcdir = @srcdir@
VPATH = @srcdir@

CC = @CC@
CCOPT = @V_CCOPT@
INCLS = -I. -I../include -I../common @V_INCLS_EXAMPLES@ @MYSQL_INCLS@
DEFS = @DEFS@
COMPATLIB = @COMPATLIB@ @LIB_SASL@ @LIBS@ @V_THREADS@ @V_GEOIPDEP@ @V_PCRE@ @V_FTDEP@ @ZLIB@ @WRAPLIBS@

MYSQLLIB = @MYSQL_LDFLAGS@ 

# Standard CFLAGS
CFLAGS = -fPIC $(CCOPT) $(INCLS) $(DEFS) $(EXTRA_CFLAGS)
INSTALL = /usr/bin/install -c
        
.PHONY: TOP all depend
        
all: TOP
SRC = argusPython.c
        
TOP: _argusPython.cpython-38-darwin.so

_argusPython.cpython-38-darwin.so:  swig.stamp

# multiple targets (left side of the colon) seems to confuse parallel make.
# create intermediate file swig.stamp instead.
argusPython_wrap.c: swig.stamp
qosient/XS/util.pm: swig.stamp
swig.stamp: argusPython.i argusPython.c setup.py
	swig -python argusPython.i
	python3 setup.py build_ext --include-dirs=../include --library-dirs=../lib
	touch swig.stamp

distclean: clean
	rm -f Makefile
clean:
	rm -rf __pycache__ argusPython.egg-info build
	rm -f *.o *.so argusPython.py argusPython_wrap.c swig.stamp

depend: $(SRC)
	../bin/mkdep -c $(CC) $(CFLAGS) $(PYTHON_CFLAGS) $(SRC)

